FROM python:3.11-slim

# Imposta la working directory
WORKDIR /app

# Copia i file necessari
COPY requirements.txt .

# Installa le dipendenze
RUN pip install --no-cache-dir -r requirements.txt

# Copia il codice sorgente
COPY predictions_service.py helper.py /app/
COPY models /app/models

# Espone la porta dell'app
EXPOSE 8084

# Comando di avvio
#CMD ["python", "-u", "predictions_service.py"]
# Command to run the application with Gunicorn
#CMD ["gunicorn", "--bind", "0.0.0.0:8084", "predictions_service:app"]

ENV PYTHONUNBUFFERED=True
ENV WORKERS=4
ENV TIMEOUT=60
ENV PORT=8084

COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh", "predictions_service:app"]

